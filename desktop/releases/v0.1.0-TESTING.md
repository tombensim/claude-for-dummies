# Claude for Beginners — v0.1.0 Testing Plan

**Version:** 0.1.0
**Date:** 2026-02-18

---

## Test Infrastructure

### Automated Tests

| Type | Runner | Config | Command |
|------|--------|--------|---------|
| Unit tests | Vitest | `vitest.config.ts` | `npm test` |
| Component tests | Vitest + Testing Library | `vitest.config.ts` | `npm test` |
| E2E tests | Playwright | `playwright.config.ts` | `npm run test:e2e` |
| Coverage | v8 via Vitest | — | `npm run test:coverage` |
| All CI | Vitest + Playwright | — | `npm run test:ci` |

### Test Files

```
__tests__/
├── setup/
│   ├── vitest.setup.tsx         # Global mocks (next-intl, next/navigation, framer-motion)
│   └── mocks/
│       ├── electron-api.ts      # Mock window.electronAPI (all IPC methods)
│       ├── electron.ts          # Mock electron module (app, ipcMain, BrowserWindow)
│       └── electron-store.ts    # In-memory electron-store mock
├── unit/
│   ├── agent-client.test.ts         # parseAgentEvent (20+ cases)
│   ├── agent-client-connect.test.ts # connectToAgent (9 cases)
│   ├── store.test.ts                # Zustand store (10+ cases)
│   └── project-utils.test.js        # slugifyIdea, deduplicatePath (10+ cases)
├── components/
│   └── ChatPanel.test.tsx           # ChatPanel rendering (7 cases)
└── e2e/
    └── full-flow.spec.ts            # Page load smoke tests (4 cases)
```

---

## Unit Test Coverage

### Agent Client — `parseAgentEvent` (agent-client.test.ts)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Returns null for system events | Automated |
| 2 | Returns null for rate_limit events | Automated |
| 3 | Returns null for user events | Automated |
| 4 | Parses assistant text content (EN) | Automated |
| 5 | Parses assistant text content (HE) | Automated |
| 6 | Parses Bash tool_use with known command (npm install) | Automated |
| 7 | Parses Bash tool_use with unknown command | Automated |
| 8 | Parses Write tool_use — extracts filename | Automated |
| 9 | Parses Edit tool_use — extracts filename | Automated |
| 10 | Parses Glob tool_use | Automated |
| 11 | Parses Grep tool_use | Automated |
| 12 | Parses Read tool_use | Automated |
| 13 | Parses generic/unknown tool_use | Automated |
| 14 | Parses successful result event | Automated |
| 15 | Parses error result event | Automated |
| 16 | Parses error event type | Automated |
| 17 | Returns null for unknown event types | Automated |
| 18 | Handles git init command | Automated |
| 19 | Handles git commit command | Automated |
| 20 | Handles npx shadcn command | Automated |
| 21 | Handles mkdir command | Automated |

### Agent Client — `connectToAgent` (agent-client-connect.test.ts)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Sends correct POST body (prompt, locale, projectDir, sessionId) | Automated |
| 2 | Parses SSE data lines and calls onMessage | Automated |
| 3 | Calls onDone on `[DONE]` marker | Automated |
| 4 | Calls onDone on stream end (no [DONE]) | Automated |
| 5 | Calls onError on HTTP error response | Automated |
| 6 | Calls onError on network failure | Automated |
| 7 | Ignores AbortError (user-initiated cancel) | Automated |
| 8 | Captures session_id and calls onSessionId | Automated |
| 9 | abort() calls AbortController.abort() | Automated |

### Store (store.test.ts)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Initial state has all default values | Automated |
| 2 | setLocale updates locale | Automated |
| 3 | addMessage appends to messages array | Automated |
| 4 | setStreaming updates isStreaming flag | Automated |
| 5 | setProjectDir updates projectDir | Automated |
| 6 | setSessionId updates sessionId | Automated |
| 7 | loadProject bulk-sets fields and resets transient state | Automated |
| 8 | reset() restores all defaults | Automated |
| 9 | loadMessages sets messages and messagesLoaded flag | Automated |
| 10 | setCurrentActivity updates activity string | Automated |
| 11 | Persistence includes correct keys in partialize | Automated |

### Project Utils (project-utils.test.js)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Strips English stop words | Automated |
| 2 | Strips Hebrew stop words | Automated |
| 3 | Takes first 3 meaningful words | Automated |
| 4 | Handles special characters / non-ASCII | Automated |
| 5 | Lowercases output | Automated |
| 6 | Falls back to "my-project" for empty input | Automated |
| 7 | Handles single-word ideas | Automated |
| 8 | deduplicatePath returns original if no collision | Automated |
| 9 | deduplicatePath appends -2 on first collision | Automated |
| 10 | deduplicatePath increments counter for multiple collisions | Automated |

---

## Component Test Coverage

### ChatPanel (ChatPanel.test.tsx)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Renders ChatHistory, ChatInput, LiveActivityBar | Automated |
| 2 | Shows ConversationRecoveryBanner when showRecoveryBanner=true | Automated |
| 3 | Hides recovery banner when showRecoveryBanner=false | Automated |
| 4 | Disables input while streaming | Automated |
| 5 | Calls onSend with message text on submit | Automated |
| 6 | Clears input field after send | Automated |
| 7 | Does not send empty messages | Automated |

---

## E2E Test Coverage

### Page Load Smoke Tests (full-flow.spec.ts)

| # | Test Case | Status |
|---|-----------|--------|
| 1 | Home page (/) loads without error | Automated |
| 2 | Setup page (/setup) loads without error | Automated |
| 3 | Welcome page (/welcome) loads without error | Automated |
| 4 | Build page (/build) loads without error | Automated |

---

## Manual Test Plan

### A. First Launch Flow

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| A1 | Fresh start | Launch app with no prior projects | Welcome page shows mascot + "Start building!" button, no recent projects |
| A2 | Create project | Click "Start building!" | Project dir created at `~/Documents/Claude Projects/new-project/`, `.cc4d/` folder present, `.git/` initialized, navigates to `/build` |
| A3 | Verify project structure | Check created directory | Contains `.cc4d/scripts/`, `.cc4d/chat-history.json` (after first message), `CLAUDE.md`, `.cc4d-progress.json` |
| A4 | Agent starts | Observe build page after creation | Chat shows streaming activity, live activity bar animates |

### B. Chat Interface

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| B1 | Send message | Type text in input, press Enter or click send | Message appears as right-aligned user bubble |
| B2 | Receive response | Wait for agent response | Assistant message shows as left-aligned white bubble with mascot avatar |
| B3 | Markdown rendering | Agent sends markdown (code, links, lists) | Rendered correctly with syntax highlighting and clickable links |
| B4 | Building blocks | Agent runs multiple tool calls | Consecutive tool calls grouped into collapsible building block with file count |
| B5 | Expand building block | Click on collapsed building block | Expands to show individual status messages |
| B6 | Live activity bar | While agent is streaming | Bottom bar shows current activity with spinner |
| B7 | Error handling | Agent encounters error | Red error pill displayed, auto-retry message shown |
| B8 | External links | Click link in assistant message | Opens in system browser via `shell:open-external` |

### C. Project Persistence

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| C1 | Chat persistence | Build a project, quit app, reopen | Chat history restored, recovery banner shown briefly |
| C2 | Session resumption | Quit mid-build, reopen, select project | Agent resumes with same session ID |
| C3 | Recent projects | Create 2+ projects, return to welcome | Both projects shown as cards with correct names and timestamps |
| C4 | Project switch | Click different project card | Navigates to build page with correct project loaded |
| C5 | Display name fallback | Project with empty displayName | Shows slug-based name instead |

### D. Logging

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| D1 | Electron logs | Run app, check `~/.claude-for-beginners/logs/electron.log` | Contains app lifecycle events, IPC calls |
| D2 | Agent logs | Send a message, check `agent.log` | Contains Claude CLI spawn and streaming events |
| D3 | Renderer logs | Trigger console.error in devtools, check `renderer.log` | Error forwarded and logged |
| D4 | Log rotation | Fill logs past 5 MB | Old file rotated to `.1`, new file started |
| D5 | npm run logs | Run `npm run logs` in terminal | Tails all 4 log files |

### E. Debug Tools

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| E1 | Toggle debug terminal | Press `Cmd+Shift+D` | Debug overlay appears at bottom 40% of screen |
| E2 | Raw events | Send message with debug terminal open | Events stream in real-time with color-coded types |
| E3 | Expand event | Click on an event row | Full JSON payload shown |
| E4 | Filter events | Type in filter box | Only matching events shown |
| E5 | Close terminal | Press `Cmd+Shift+D` again | Overlay hides |

### F. i18n

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| F1 | Hebrew mode | Set locale to Hebrew | All UI text in Hebrew, layout RTL |
| F2 | English mode | Toggle to English | All UI text in English, layout LTR |
| F3 | Language toggle | Click language toggle in header | Locale switches, UI updates immediately |
| F4 | Status messages | Observe build status in both locales | Tool activity messages shown in correct language |

### G. Edge Cases

| # | Scenario | Steps | Expected Result |
|---|----------|-------|-----------------|
| G1 | Port conflict | Start app while port 3456 is in use | Graceful error or alternate port |
| G2 | No Claude CLI | Remove/rename `~/.local/bin/claude`, send message | Error message displayed, not a crash |
| G3 | Disk full | Fill disk, try to create project | Error handled gracefully |
| G4 | Project dir deleted | Delete project folder externally, try to switch to it | Error handled, project not loaded |
| G5 | Rapid messages | Send multiple messages quickly | Previous request aborted, latest processed |
| G6 | Very long message | Send a 5000+ character message | Message renders without layout break |
| G7 | Network disconnect | Lose network mid-stream | Error message shown, can retry |

---

## Running Tests

```bash
# All unit + component tests
npm test

# Watch mode (re-runs on file changes)
npm run test:watch

# With coverage report
npm run test:coverage

# E2E only (requires dev server running)
npm run test:e2e

# Full CI suite
npm run test:ci

# Specific test file
npx vitest run __tests__/unit/store.test.ts
```

---

## Test Environment Requirements

- **Node.js** 20+
- **macOS** (Electron requires macOS for Mac builds)
- **Claude CLI** installed at `~/.local/bin/claude` (for E2E agent tests)
- **Port 3456** available (Next.js dev server)

---

## Acceptance Criteria for v0.1.0

- [ ] All automated tests pass (`npm run test:ci`)
- [ ] App launches without error on macOS
- [ ] Can create a new project from welcome page
- [ ] Chat messages send and receive correctly
- [ ] Chat history persists across app restarts
- [ ] Recent projects appear on welcome page
- [ ] Can switch between projects
- [ ] Logging works (all 4 log files written)
- [ ] Debug terminal toggles with keyboard shortcut
- [ ] Hebrew and English locales work correctly
- [ ] `npm run package` produces a working .app bundle
